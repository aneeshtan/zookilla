{"ast":null,"code":"var _jsxFileName = \"/Users/farshadghazanfari/Documents/www/npat/components/Game/ResultsTable.js\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useState, useEffect } from 'react';\nimport styled from 'styled-components';\nimport { Button, Spinner, FlexColumn, FlexContainer } from '../StyledComponents';\nimport theme from '../../constants/theme';\nimport { socket } from '../../constants/websocket';\nimport Papa from 'papaparse';\nconst TableContainer = styled.div.withConfig({\n  displayName: \"ResultsTable__TableContainer\",\n  componentId: \"sc-1lg56mx-0\"\n})([\"display:flex;flex-wrap:wrap;justify-content:space-around;\"]);\nconst Container = styled.div.withConfig({\n  displayName: \"ResultsTable__Container\",\n  componentId: \"sc-1lg56mx-1\"\n})([\"padding:20px 0;display:flex;flex-direction:row;justify-content:center;flex-wrap:wrap;\"]);\nconst Paper = styled.div.withConfig({\n  displayName: \"ResultsTable__Paper\",\n  componentId: \"sc-1lg56mx-2\"\n})([\"background:white;background-size:100% 1.2em;height:auto;margin:0 auto;margin-top:30px;box-shadow:#9e9e9e63 6px 7px 14px 0px;width:250px;padding:30px 30px 30px 30px;background-image:linear-gradient(90deg,transparent 49px,transparent 49px,transparent 51px,transparent 51px),linear-gradient(#eee .1em,transparent .1em);\"]);\nconst Submission = styled.span.withConfig({\n  displayName: \"ResultsTable__Submission\",\n  componentId: \"sc-1lg56mx-3\"\n})([\"color:\", \";word-break:break-all;\"], theme.colors.blue);\nconst StyledIncrementButton = styled.button.withConfig({\n  displayName: \"ResultsTable__StyledIncrementButton\",\n  componentId: \"sc-1lg56mx-4\"\n})([\"font-weight:bold;font-size:14px;border:\", \";color:\", \";cursor:\", \";\"], props => props.disabled ? '1px solid gray' : '1px solid black', props => props.disabled ? 'gray' : 'black', props => props.disabled ? 'not-allowed' : 'pointer');\nconst InputContainer = styled.div.withConfig({\n  displayName: \"ResultsTable__InputContainer\",\n  componentId: \"sc-1lg56mx-5\"\n})([\"margin-left:15px;font-size:1.5em;display:flex;align-items:center;width:80px;justify-content:space-between;\"]);\nconst NumberContainer = styled.div.withConfig({\n  displayName: \"ResultsTable__NumberContainer\",\n  componentId: \"sc-1lg56mx-6\"\n})([\"margin-left:15px;font-size:1.5em;display:flex;align-items:center;width:80px;justify-content:center;\"]);\n\nconst ResultsTable = ({\n  gameState,\n  round,\n  handleSubmitScore,\n  scoreSubmitted,\n  scorePartner\n}) => {\n  let initialScore = {};\n  const {\n    0: scores,\n    1: setScores\n  } = useState({});\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(true);\n  const categories = gameState.categories;\n  let scoringId = gameState.scoringType === \"cross\" ? scorePartner.id : socket.id;\n  let users = sortUserList([...gameState.users], scoringId);\n  users.forEach(user => {\n    categories.forEach(cat => {\n      let similar = similarityCheck(cat, users, user.id, round);\n\n      if (user.id === scoringId && similar.value) {\n        initialScore = Object.assign({}, initialScore, {\n          [cat]: 5\n        });\n      }\n    });\n  });\n  const {\n    0: gameData,\n    1: setGameData\n  } = useState({\n    currentScore: initialScore,\n    animalsSet: new Set(),\n    namesSet: new Set(),\n    thingsSet: new Set(),\n    placesSet: new Set(),\n    booksSet: new Set(),\n    celebritiesSet: new Set(),\n    fruitsSet: new Set(),\n    instrumentsSet: new Set(),\n    moviesSet: new Set(),\n    musiciansSet: new Set(),\n    songsSet: new Set(),\n    tv_showsSet: new Set(),\n    musiciansSet: new Set()\n  });\n\n  const parseCSV = async filePath => {\n    const response = await fetch(filePath);\n    const reader = response.body.getReader();\n    const result = await reader.read();\n    const decoder = new TextDecoder('utf-8');\n    const csv = decoder.decode(result.value);\n    return new Promise((resolve, reject) => {\n      Papa.parse(csv, {\n        complete: results => {\n          resolve(results.data.map(row => row[0]));\n        },\n        error: reject\n      });\n    });\n  };\n\n  useEffect(() => {\n    const categories = ['animals', 'places', 'names', 'things', 'books', 'songs', 'tv_shows', 'movies', 'instruments', 'musicians', 'fruits'];\n    Promise.all(categories.map(category => parseCSV(`/csv/${category}.csv`).then(data => {\n      setGameData(prevGameData => _objectSpread({}, prevGameData, {\n        [`${category}Set`]: new Set(data.map(item => item.toLowerCase().trim()))\n      }));\n    })));\n  }, []); // Empty dependency array to run only once on mount\n\n  const scoreEntriesAI = async () => {\n    if (animalsSet.size === 0) {\n      console.log(\"Waiting for animalsSet to be populated...\");\n      return; // Exit if animalsSet is not ready\n    }\n\n    const newScores = {};\n\n    for (const category of categories) {\n      for (const user of gameState.users) {\n        const answer = user.responses[round][category];\n\n        if (answer) {\n          const score = await getScoreFromAPI(category, answer);\n          newScores[user.id] = _objectSpread({}, newScores[user.id] || {}, {\n            [category]: score\n          });\n        }\n      }\n    }\n\n    setScores(newScores);\n    setLoading(false);\n  };\n\n  const getScoreFromAPI = async (category, answer) => {\n    try {\n      const formattedAnswer = answer.toLowerCase().trim();\n      const categorySets = {\n        Animal: animalsSet,\n        Name: namesSet,\n        Thing: thingsSet,\n        Place: placesSet,\n        Songs: songsSet,\n        TV_shows: tv_showsSet,\n        Books: booksSet,\n        Celebrities: celebritiesSet,\n        Musicians: musiciansSet,\n        Instruments: instrumentsSet\n      };\n      let categorySet = categorySets[category] || new Set();\n      let isExactMatch = false;\n      let isSimilarMatch = false;\n      categorySet.forEach(item => {\n        if (formattedAnswer === item) {\n          isExactMatch = true;\n        } else if (formattedAnswer.includes(item) || item.includes(formattedAnswer)) {\n          isSimilarMatch = true;\n        }\n      });\n\n      if (isExactMatch) {\n        console.log(`'${formattedAnswer}' is an exact match in ${category}.`);\n        return 10; // Exact match\n      } else if (isSimilarMatch) {\n        console.log(`'${formattedAnswer}' is a similar match in ${category}.`);\n        return 5; // Similar match\n      } else {\n        console.log(`'${formattedAnswer}' is not found in the ${category} set.`);\n      }\n\n      return 0; // Answer is incorrect or not in the category\n    } catch (error) {\n      console.error(\"Error checking answer:\", error);\n      return 0;\n    }\n  };\n\n  let totalScore = 0;\n  useEffect(() => {\n    if (gameState.scoringType === \"ai\" && animalsSet.size > 0) {\n      scoreEntriesAI();\n    }\n  }, [gameState, round, animalsSet, namesSet, thingsSet, placesSet]); // Add animalsSet as a dependency\n\n  if (loading) {\n    return __jsx(Spinner, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 12\n      }\n    });\n  }\n\n  return __jsx(React.Fragment, null, gameState.scoringType === \"ai\" ? __jsx(TableContainer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 3\n    }\n  }, gameState.users.map(user => __jsx(Paper, {\n    key: user.id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 5\n    }\n  }, __jsx(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 7\n    }\n  }, user.name), gameState.categories.map(category => __jsx(\"div\", {\n    key: category,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 9\n    }\n  }, category, \": \", __jsx(Submission, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 23\n    }\n  }, user.responses[round][category] || '-'), __jsx(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 11\n    }\n  }, \"Score: \", scores[user.id] && scores[user.id][category]))), __jsx(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 7\n    }\n  }, \"Total Score: \", Object.values(scores[user.id] || {}).reduce((a, b) => a + b, 0))))) : __jsx(React.Fragment, null, gameState.scoringType === \"cross\" ? __jsx(FlexContainer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 42\n    }\n  }, __jsx(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 57\n    }\n  }, \"You are scoring for \", __jsx(Submission, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 81\n    }\n  }, scorePartner.name), \"!\")) : false, __jsx(TableContainer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 5\n    }\n  }, users.map(user => __jsx(Paper, {\n    key: user.id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 26\n    }\n  }, __jsx(\"h2\", {\n    style: {\n      display: 'flex',\n      justifyContent: 'space-between'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 9\n    }\n  }, __jsx(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 74\n    }\n  }, user.name), user.id === scoringId ? __jsx(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 36\n    }\n  }, \"Score\") : false), categories.map(category => {\n    let similar = similarityCheck(category, users, user.id, round);\n    let selfScoreCard = user.id === scoringId;\n    return __jsx(React.Fragment, {\n      key: category,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 18\n      }\n    }, similar.value && selfScoreCard ? __jsx(\"span\", {\n      style: {\n        color: theme.colors.red\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 47\n      }\n    }, scorePartner.name || 'You', \" and \", similar.name, \" put down the same word for \", category) : false, __jsx(\"div\", {\n      style: {\n        marginBottom: '10px',\n        display: \"flex\",\n        justifyContent: 'space-between',\n        alignItems: 'center'\n      },\n      key: category,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 13\n      }\n    }, __jsx(\"div\", {\n      style: {\n        width: selfScoreCard ? \"150px\" : \"auto\",\n        fontSize: \"1.2em\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 15\n      }\n    }, category, \":\", `  `, \" \", __jsx(Submission, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 35\n      }\n    }, user.responses[round][category] || '-')), selfScoreCard ? user.responses[round][category] ? __jsx(InputContainer, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 51\n      }\n    }, __jsx(NumberInput, {\n      category: category,\n      setCurrentScore: setCurrentScore,\n      currentScore: currentScore,\n      value: similar.value ? 5 : 0,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 19\n      }\n    }), \" \") : __jsx(NumberContainer, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 167\n      }\n    }, \"0\") : ''));\n  }), user.id === scoringId ? __jsx(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 34\n    }\n  }, `Total Score: ${sumAllScores(currentScore)}`) : false)))), __jsx(Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 5\n    }\n  }, !scoreSubmitted ? __jsx(React.Fragment, null, __jsx(Button, {\n    onClick: event => {\n      event.preventDefault();\n      handleSubmitScore(totalScore, scoringId);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 268,\n      columnNumber: 9\n    }\n  }, \"Submit\")) : __jsx(FlexColumn, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 13\n    }\n  }, __jsx(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 273,\n      columnNumber: 11\n    }\n  }, \"Waiting for others\"), __jsx(Spinner, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 274,\n      columnNumber: 11\n    }\n  }))));\n};\n\nconst similarityCheck = (category, users, currentUserId, round) => {\n  let currentUser = users.find(user => user.id === currentUserId);\n  let currentUserResponse = currentUser.responses[round][category] ? currentUser.responses[round][category].toLowerCase().trim() : null;\n  let value = false;\n  let name = null;\n  users.filter(user => user.id !== currentUserId).forEach(user => {\n    let otherResponse = user.responses[round][category] ? user.responses[round][category].toLowerCase().trim() : null;\n\n    if (currentUserResponse && otherResponse && currentUserResponse === otherResponse) {\n      value = true;\n      name = user.name;\n    }\n\n    return;\n  });\n  return {\n    value,\n    name\n  };\n};\n\nconst sumAllScores = scores => Object.keys(scores).map(cat => scores[cat]).reduce((a, b) => a + b, 0);\n\nconst NumberInput = ({\n  value,\n  currentScore,\n  setCurrentScore,\n  category\n}) => {\n  const {\n    0: numberValue,\n    1: setNumberValue\n  } = useState(value);\n  useEffect(() => {\n    setCurrentScore(Object.assign({}, currentScore, {\n      [category]: value\n    }));\n  }, []);\n\n  const onMinus = () => {\n    setCurrentScore(Object.assign({}, currentScore, {\n      [category]: numberValue - 5\n    }));\n    if (!(numberValue <= 0)) setNumberValue(numberValue - 5);\n  };\n\n  const onPlus = () => {\n    setCurrentScore(Object.assign({}, currentScore, {\n      [category]: numberValue + 5\n    }));\n    if (!(numberValue >= 10)) setNumberValue(numberValue + 5);\n  };\n\n  return __jsx(React.Fragment, null, __jsx(StyledIncrementButton, {\n    disabled: numberValue === 0,\n    onClick: () => onMinus(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 12\n    }\n  }, \"-\"), numberValue, __jsx(StyledIncrementButton, {\n    disabled: numberValue === 10,\n    onClick: () => onPlus(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 128\n    }\n  }, \"+\"));\n};\n\nconst sortUserList = (users, scoringId) => {\n  let index = users.findIndex(user => user.id === scoringId);\n\n  if (index != -1) {\n    let first = users.splice(index, 1)[0];\n    users.unshift(first);\n    return users;\n  }\n\n  return users;\n};\n\nexport default ResultsTable;","map":{"version":3,"sources":["/Users/farshadghazanfari/Documents/www/npat/components/Game/ResultsTable.js"],"names":["React","useState","useEffect","styled","Button","Spinner","FlexColumn","FlexContainer","theme","socket","Papa","TableContainer","div","Container","Paper","Submission","span","colors","blue","StyledIncrementButton","button","props","disabled","InputContainer","NumberContainer","ResultsTable","gameState","round","handleSubmitScore","scoreSubmitted","scorePartner","initialScore","scores","setScores","loading","setLoading","categories","scoringId","scoringType","id","users","sortUserList","forEach","user","cat","similar","similarityCheck","value","Object","assign","gameData","setGameData","currentScore","animalsSet","Set","namesSet","thingsSet","placesSet","booksSet","celebritiesSet","fruitsSet","instrumentsSet","moviesSet","musiciansSet","songsSet","tv_showsSet","parseCSV","filePath","response","fetch","reader","body","getReader","result","read","decoder","TextDecoder","csv","decode","Promise","resolve","reject","parse","complete","results","data","map","row","error","all","category","then","prevGameData","item","toLowerCase","trim","scoreEntriesAI","size","console","log","newScores","answer","responses","score","getScoreFromAPI","formattedAnswer","categorySets","Animal","Name","Thing","Place","Songs","TV_shows","Books","Celebrities","Musicians","Instruments","categorySet","isExactMatch","isSimilarMatch","includes","totalScore","name","values","reduce","a","b","display","justifyContent","selfScoreCard","color","red","marginBottom","alignItems","width","fontSize","setCurrentScore","sumAllScores","event","preventDefault","currentUserId","currentUser","find","currentUserResponse","filter","otherResponse","keys","NumberInput","numberValue","setNumberValue","onMinus","onPlus","index","findIndex","first","splice","unshift"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport styled from 'styled-components';\nimport { Button, Spinner, FlexColumn, FlexContainer } from '../StyledComponents'\nimport theme from '../../constants/theme'\nimport { socket } from '../../constants/websocket'\nimport Papa from 'papaparse';\n\nconst TableContainer = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-around;\n`\n\nconst Container = styled.div`\n  padding: 20px 0;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  flex-wrap: wrap;\n`\n\nconst Paper = styled.div`\n  background: white;\n  background-size: 100% 1.2em;\n  height: auto;\n  margin: 0 auto;\n  margin-top: 30px;\n  box-shadow: #9e9e9e63 6px 7px 14px 0px;\n  width: 250px;\n  padding: 30px 30px 30px 30px;\n  background-image:\n  linear-gradient(90deg, transparent 49px, transparent 49px, transparent 51px, transparent 51px),\n  linear-gradient(#eee .1em, transparent .1em);\n`\n\nconst Submission = styled.span`\n  color: ${theme.colors.blue};\n  word-break: break-all;\n`\n\nconst StyledIncrementButton = styled.button`\n  font-weight: bold;\n  font-size: 14px;\n  border: ${props => props.disabled ? '1px solid gray' : '1px solid black'};\n  color: ${props => props.disabled ? 'gray' : 'black'};\n  cursor: ${props => props.disabled ? 'not-allowed' : 'pointer'};\n`\n\nconst InputContainer = styled.div`\n  margin-left: 15px;\n  font-size: 1.5em;\n  display: flex;\n  align-items: center;\n  width: 80px;\n  justify-content: space-between;\n`\n\nconst NumberContainer = styled.div`\n  margin-left: 15px;\n  font-size: 1.5em;\n  display: flex;\n  align-items: center;\n  width: 80px;\n  justify-content: center;\n`\n\nconst ResultsTable = ({ gameState, round, handleSubmitScore, scoreSubmitted, scorePartner }) => {\n  let initialScore = {}\n  const [scores, setScores] = useState({});\n  const [loading, setLoading] = useState(true);\n  const categories = gameState.categories;\n  let scoringId = gameState.scoringType === \"cross\" ? scorePartner.id : socket.id;\n  let users = sortUserList([...gameState.users], scoringId);\n\n  users.forEach(user => {\n    categories.forEach(cat => {\n      let similar = similarityCheck(cat, users, user.id, round)\n      if (user.id === scoringId && similar.value) {\n\n        initialScore = Object.assign({}, initialScore, { [cat]: 5 })\n      }\n    })\n  })\n\n  const [gameData, setGameData] = useState({\n    currentScore: initialScore,\n    animalsSet: new Set(),\n    namesSet: new Set(),\n    thingsSet: new Set(),\n    placesSet: new Set(),\n    \n    booksSet: new Set(),\n    celebritiesSet: new Set(),\n    fruitsSet: new Set(),\n    instrumentsSet: new Set(),\n    moviesSet: new Set(),\n    musiciansSet: new Set(),\n    songsSet: new Set(),\n    tv_showsSet: new Set(),\n    musiciansSet: new Set(),\n\n\n\n  });\n\n  const parseCSV = async (filePath) => {\n    const response = await fetch(filePath);\n    const reader = response.body.getReader();\n    const result = await reader.read();\n    const decoder = new TextDecoder('utf-8');\n    const csv = decoder.decode(result.value);\n    return new Promise((resolve, reject) => {\n      Papa.parse(csv, {\n        complete: (results) => {\n          resolve(results.data.map(row => row[0]));\n        },\n        error: reject\n      });\n    });\n  };\n\n\n  useEffect(() => {\n    const categories = ['animals', 'places', 'names', 'things','books','songs','tv_shows','movies','instruments','musicians','fruits'];\n    Promise.all(categories.map(category =>\n      parseCSV(`/csv/${category}.csv`).then(data => {\n        setGameData(prevGameData => ({\n          ...prevGameData,\n          [`${category}Set`]: new Set(data.map(item => item.toLowerCase().trim())),\n        }));\n      })\n    ));\n  }, []); // Empty dependency array to run only once on mount\n\n\n  const scoreEntriesAI = async () => {\n\n    if (animalsSet.size === 0) {\n      console.log(\"Waiting for animalsSet to be populated...\");\n      return; // Exit if animalsSet is not ready\n    }\n\n    const newScores = {};\n    for (const category of categories) {\n      for (const user of gameState.users) {\n        const answer = user.responses[round][category];\n        if (answer) {\n          const score = await getScoreFromAPI(category, answer);\n          newScores[user.id] = { ...(newScores[user.id] || {}), [category]: score };\n        }\n      }\n    }\n    setScores(newScores);\n    setLoading(false);\n  };\n\n\n  const getScoreFromAPI = async (category, answer) => {\n    try {\n        const formattedAnswer = answer.toLowerCase().trim();\n        const categorySets = {\n          Animal: animalsSet,\n          Name: namesSet,\n          Thing: thingsSet,\n          Place: placesSet,\n          Songs: songsSet,\n          TV_shows: tv_showsSet,\n          Books: booksSet,\n          Celebrities: celebritiesSet,\n          Musicians: musiciansSet,\n          Instruments: instrumentsSet,\n        };\n        \n        let categorySet = categorySets[category] || new Set();\n\n        let isExactMatch = false;\n        let isSimilarMatch = false;\n\n        categorySet.forEach(item => {\n            if (formattedAnswer === item) {\n                isExactMatch = true;\n            } else if (formattedAnswer.includes(item) || item.includes(formattedAnswer)) {\n                isSimilarMatch = true;\n            }\n        });\n\n        if (isExactMatch) {\n            console.log(`'${formattedAnswer}' is an exact match in ${category}.`);\n            return 10; // Exact match\n        } else if (isSimilarMatch) {\n            console.log(`'${formattedAnswer}' is a similar match in ${category}.`);\n            return 5; // Similar match\n        } else {\n            console.log(`'${formattedAnswer}' is not found in the ${category} set.`);\n        }\n\n        return 0; // Answer is incorrect or not in the category\n    } catch (error) {\n        console.error(\"Error checking answer:\", error);\n        return 0;\n    }\n};\n\n\n\n  let totalScore = 0;\n  useEffect(() => {\n    if(gameState.scoringType === \"ai\" && animalsSet.size > 0) {\n      scoreEntriesAI();\n    }\n  }, [gameState, round, animalsSet, namesSet, thingsSet, placesSet]); // Add animalsSet as a dependency\n  \n\n\n  if (loading) {\n    return <Spinner />;\n  }\n\n  return <>\n\n{gameState.scoringType === \"ai\" ? ( \n  <TableContainer>\n  {gameState.users.map(user => (\n    <Paper key={user.id}>\n      <h2>{user.name}</h2>\n      {gameState.categories.map(category => (\n        <div key={category}>\n          {category}: <Submission>{user.responses[round][category] || '-'}</Submission>\n          <span>Score: {scores[user.id] && scores[user.id][category]}</span>\n        </div>\n      ))}\n      <h2>Total Score: {Object.values(scores[user.id] || {}).reduce((a, b) => a + b, 0)}</h2>\n    </Paper>\n  ))}\n</TableContainer>\n    ) : (\n      <>\n    {gameState.scoringType === \"cross\" ? <FlexContainer><h1>You are scoring for <Submission>{scorePartner.name}</Submission>!</h1></FlexContainer> : false}\n    <TableContainer>\n      {users.map(user => <Paper key={user.id}>\n        <h2 style={{ display: 'flex', justifyContent: 'space-between' }}><span>{user.name}</span>\n          {user.id === scoringId ? <span>Score</span> : false}\n        </h2>\n        {categories.map(category => {\n          let similar = similarityCheck(category, users, user.id, round)\n          let selfScoreCard = user.id === scoringId;\n          return <React.Fragment key={category}>\n            {similar.value && selfScoreCard ? <span style={{ color: theme.colors.red }}>{scorePartner.name || 'You'} and {similar.name} put down the same word for {category}</span> : false}\n            <div style={{ marginBottom: '10px', display: \"flex\", justifyContent: 'space-between', alignItems: 'center' }} key={category}>\n              <div style={{ width: selfScoreCard ? \"150px\" : \"auto\", fontSize: \"1.2em\" }}>\n                {category}:{`  `} <Submission>{user.responses[round][category] || '-'}</Submission>\n              </div>\n              {selfScoreCard ?\n                user.responses[round][category] ? <InputContainer>\n                  <NumberInput category={category} setCurrentScore={setCurrentScore} currentScore={currentScore} value={similar.value ? 5 : 0} /> </InputContainer> : <NumberContainer>0</NumberContainer>\n                : ''}\n            </div>\n          </React.Fragment>\n        }\n        )}\n        {user.id === scoringId ? <h2>{`Total Score: ${sumAllScores(currentScore)}`}</h2> : false}\n      </Paper>)}\n    </TableContainer>\n    </>\n    )}\n    <Container>\n      {!scoreSubmitted ? <>\n        <Button onClick={(event) => {\n          event.preventDefault()\n          handleSubmitScore(totalScore, scoringId)\n        }}>Submit</Button>\n      </> : <FlexColumn>\n          <h2>Waiting for others</h2>\n          <Spinner />\n        </FlexColumn>}\n    </Container>\n  </>\n  \n}\n\nconst similarityCheck = (category, users, currentUserId, round) => {\n  let currentUser = users.find(user => user.id === currentUserId);\n  let currentUserResponse = currentUser.responses[round][category] ? currentUser.responses[round][category].toLowerCase().trim() : null;\n\n  let value = false;\n  let name = null;\n  users.filter(user => user.id !== currentUserId).forEach(user => {\n    let otherResponse = user.responses[round][category] ? user.responses[round][category].toLowerCase().trim() : null;\n    if (currentUserResponse && otherResponse && (currentUserResponse === otherResponse)) {\n      value = true;\n      name = user.name\n    }\n    return;\n  })\n  return { value, name };\n}\n\nconst sumAllScores = (scores) => Object.keys(scores).map(cat => scores[cat]).reduce((a, b) => a + b, 0)\n\nconst NumberInput = ({ value, currentScore, setCurrentScore, category }) => {\n  const [numberValue, setNumberValue] = useState(value)\n  useEffect(() => {\n    setCurrentScore(Object.assign({}, currentScore, { [category]: value }))\n  }, [])\n\n  const onMinus = () => {\n    setCurrentScore(Object.assign({}, currentScore, { [category]: numberValue - 5 }))\n    if (!(numberValue <= 0)) setNumberValue(numberValue - 5)\n  }\n\n  const onPlus = () => {\n    setCurrentScore(Object.assign({}, currentScore, { [category]: numberValue + 5 }))\n    if (!(numberValue >= 10)) setNumberValue(numberValue + 5)\n  }\n  return <><StyledIncrementButton disabled={numberValue === 0} onClick={() => onMinus()}>-</StyledIncrementButton>{numberValue}<StyledIncrementButton disabled={numberValue === 10} onClick={() => onPlus()}>+</StyledIncrementButton></>\n}\n\n\nconst sortUserList = (users, scoringId) => {\n  let index = users.findIndex(user => user.id === scoringId);\n  if (index != -1) {\n    let first = users.splice(index, 1)[0];\n    users.unshift(first);\n    return users;\n  }\n  return users\n}\n\n\nexport default ResultsTable;"]},"metadata":{},"sourceType":"module"}