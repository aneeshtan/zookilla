{"ast":null,"code":"var _this = this,\n    _jsxFileName = \"/Users/farshadghazanfari/Documents/www/npat/components/Game/Play.js\";\n\nvar __jsx = React.createElement;\nimport React, { useState, useEffect } from 'react';\nimport styled from 'styled-components';\nimport theme from '../../constants/theme';\nimport { socket } from '../../constants/websocket';\nimport { FlexContainer, Spinner, ExitButton, ExitButtonContainer } from '../StyledComponents';\nimport InputTable from './InputTable';\nimport ResultsTable from './ResultsTable';\nimport ScoreTable from './ScoreTable';\nimport ActivePlayers from './PlayerList';\nimport GameHeader from './GameHeader';\nimport FinalScreen from './FinalScreen';\nimport StartGameScreen from './StartGameScreen';\nvar Container = styled.div.withConfig({\n  displayName: \"Play__Container\",\n  componentId: \"q76vgx-0\"\n})([\"font-family:\", \";padding-top:80px;\"], theme.font);\n\nvar Play = function Play(_ref) {\n  var gameData = _ref.gameData,\n      setGamePlaying = _ref.setGamePlaying,\n      soundOn = _ref.soundOn;\n\n  var _useState = useState([]),\n      users = _useState[0],\n      setUsers = _useState[1];\n\n  var _useState2 = useState(''),\n      code = _useState2[0],\n      setCode = _useState2[1];\n\n  var _useState3 = useState(1),\n      currentGameRound = _useState3[0],\n      setCurrentGameRound = _useState3[1];\n\n  var _useState4 = useState(false),\n      responseSubmitted = _useState4[0],\n      setResponseSubmitted = _useState4[1];\n\n  var _useState5 = useState(false),\n      scoreSubmitted = _useState5[0],\n      setScoreSubmitted = _useState5[1];\n\n  var _useState6 = useState(false),\n      allScoresCollected = _useState6[0],\n      setAllScoresCollected = _useState6[1];\n\n  var _useState7 = useState(false),\n      allResponsesCollected = _useState7[0],\n      setAllResponsesCollected = _useState7[1];\n\n  var _useState8 = useState(''),\n      currentAlphabet = _useState8[0],\n      setCurrentAlphabet = _useState8[1];\n\n  var _useState9 = useState({}),\n      gameState = _useState9[0],\n      setGameState = _useState9[1];\n\n  var _useState10 = useState(false),\n      gameStarted = _useState10[0],\n      startGame = _useState10[1];\n\n  var _useState11 = useState(0),\n      timerValue = _useState11[0],\n      setTimerValue = _useState11[1];\n\n  var _useState12 = useState(false),\n      loading = _useState12[0],\n      setLoading = _useState12[1];\n\n  var _useState13 = useState(false),\n      gameEnded = _useState13[0],\n      setGameEnded = _useState13[1];\n\n  var _useState14 = useState([]),\n      finalScores = _useState14[0],\n      setFinalScores = _useState14[1];\n\n  var _useState15 = useState(0),\n      maxRounds = _useState15[0],\n      setMaxRounds = _useState15[1];\n\n  var _useState16 = useState([]),\n      categories = _useState16[0],\n      setCategories = _useState16[1];\n\n  var _useState17 = useState(gameData.isAdmin),\n      isAdmin = _useState17[0],\n      setAdmin = _useState17[1];\n\n  var _useState18 = useState({}),\n      scorePartner = _useState18[0],\n      setScorePartner = _useState18[1]; // const isAdmin = gameData.isAdmin;\n\n\n  useEffect(function () {\n    var code = gameData.code,\n        users = gameData.users,\n        maxRounds = gameData.maxRounds,\n        categories = gameData.categories;\n    setUsers(users);\n    setCode(code);\n    setMaxRounds(Number(maxRounds));\n    setCategories(categories);\n  }, [gameData]);\n  useEffect(function () {\n    socket.on(\"restartGame\", function () {\n      setFinalScores([]);\n      setGameEnded(false);\n    });\n    socket.on(\"gameData\", function (_ref2) {\n      var users = _ref2.users;\n      setUsers(users);\n    });\n    socket.on(\"allSubmitted\", function (_ref3) {\n      var gameState = _ref3.gameState,\n          scorePartners = _ref3.scorePartners;\n      setGameState(Object.assign({}, gameState));\n      scorePartners.forEach(function (scorePartner) {\n        if (scorePartner[0].id === socket.id) {\n          setScorePartner(scorePartner[1]);\n        }\n      });\n      setAllResponsesCollected(true);\n    });\n    socket.on(\"allScoresSubmitted\", function (_ref4) {\n      var gameState = _ref4.gameState;\n      setGameState(Object.assign({}, gameState));\n      setAllScoresCollected(true);\n    });\n    socket.on(\"allPlayersReady\", function (_ref5) {\n      var gameState = _ref5.gameState;\n      setLoading(true);\n      setGameState(Object.assign({}, gameState));\n      setCurrentGameRound(gameState.currentRound);\n      setResponseSubmitted(false);\n      setAllResponsesCollected(false);\n      setAllScoresCollected(false);\n      setScoreSubmitted(false);\n      setTimerValue(0);\n      setCurrentAlphabet(gameState.currentAlphabet);\n      setLoading(false);\n    });\n    socket.on(\"gameStarted\", function (_ref6) {\n      var gameState = _ref6.gameState;\n      startGame(gameState.started);\n      setCurrentAlphabet(gameState.currentAlphabet);\n    });\n    socket.on(\"gameEnded\", function (_ref7) {\n      var scores = _ref7.scores,\n          gameState = _ref7.gameState;\n      setLoading(true);\n      setGameState(Object.assign({}, gameState));\n      setCurrentGameRound(1);\n      setResponseSubmitted(false);\n      setAllResponsesCollected(false);\n      setAllScoresCollected(false);\n      setScoreSubmitted(false);\n      setTimerValue(0);\n      setCurrentAlphabet('');\n      setGameEnded(true);\n      startGame(false);\n      setLoading(false);\n      setUsers(gameState.users); // New person who starts the game will be admin\n\n      setAdmin(false);\n      setFinalScores(scores);\n    });\n    socket.on(\"timerValue\", function (_ref8) {\n      var timer = _ref8.timer;\n      setTimerValue(timer);\n    });\n  }, []); // Sumbit users respnse\n\n  var sendResponse = function sendResponse(response) {\n    // forEach category, make a response object\n    socket.emit('sendResponse', {\n      code: code,\n      response: response,\n      round: currentGameRound\n    }, function () {\n      setResponseSubmitted(true);\n      socket.emit('stopTimer', {\n        code: code\n      });\n    });\n  };\n\n  var handleSubmitScore = function handleSubmitScore(score, id) {\n    var submitScore;\n    submitScore = score ? score : 0;\n    socket.emit('sendScore', {\n      id: id,\n      code: code,\n      score: submitScore,\n      round: currentGameRound\n    }, function (_ref9) {\n      var error = _ref9.error,\n          gameState = _ref9.gameState;\n      if (error) alert(error);else if (gameState) {\n        setScoreSubmitted(true);\n      }\n    });\n  };\n\n  var handleStartGame = function handleStartGame() {\n    socket.emit('startGame', {\n      code: code\n    }, function (gameState) {\n      if (gameState) {\n        startGame(gameState.started);\n        setLoading(false);\n      }\n    });\n  };\n\n  var handleRestartGame = function handleRestartGame(event) {\n    event.preventDefault();\n    startGame(false);\n    socket.emit('restartGame', {\n      code: code\n    }, function () {\n      setFinalScores([]);\n      setGameEnded(false);\n      setAdmin(true);\n    });\n  };\n\n  var handleStartNextRound = function handleStartNextRound() {\n    // If everyone is ready to start next round, then start next round \n    socket.emit('playerReady', {\n      code: code,\n      round: currentGameRound\n    }, function (_ref10) {\n      var gameState = _ref10.gameState;\n\n      if (gameState) {}\n    });\n  };\n\n  var renderGameState = function renderGameState() {\n    if (loading) return __jsx(FlexContainer, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 25\n      }\n    }, __jsx(Spinner, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 40\n      }\n    }));\n    if (gameEnded) return __jsx(FinalScreen, {\n      handleRestartGame: handleRestartGame,\n      scores: finalScores,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 27\n      }\n    });\n    if (!gameStarted) return __jsx(StartGameScreen, {\n      handleStartGame: handleStartGame,\n      isAdmin: isAdmin,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 30\n      }\n    });else if (allScoresCollected) return __jsx(ScoreTable, {\n      maxRounds: maxRounds,\n      handleStartNextRound: handleStartNextRound,\n      round: currentGameRound,\n      gameState: gameState,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 14\n      }\n    });else if (responseSubmitted && !allResponsesCollected) return __jsx(FlexContainer, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 14\n      }\n    }, __jsx(Spinner, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 29\n      }\n    }));else if (allResponsesCollected) return __jsx(ResultsTable, {\n      scorePartner: scorePartner,\n      scoreSubmitted: scoreSubmitted,\n      handleSubmitScore: handleSubmitScore,\n      round: currentGameRound,\n      gameState: gameState,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 14\n      }\n    });else return __jsx(React.Fragment, null, gameStarted ? __jsx(GameHeader, {\n      soundOn: soundOn,\n      maxRounds: maxRounds,\n      timerValue: timerValue,\n      roundNumber: currentGameRound,\n      currentAlphabet: currentAlphabet,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 26\n      }\n    }) : false, __jsx(InputTable, {\n      categories: categories,\n      timerValue: timerValue,\n      sendResponse: sendResponse,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 9\n      }\n    }));\n  };\n\n  return __jsx(Container, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 10\n    }\n  }, __jsx(ExitButtonContainer, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 5\n    }\n  }, __jsx(ExitButton, {\n    onClick: function onClick() {\n      socket.emit('removeUserFromGame', {\n        code: code\n      }, function () {\n        gtag(\"event\", \"close_game\");\n        setGamePlaying(false);\n      });\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 26\n    }\n  }, \"X\")), !gameEnded && __jsx(ActivePlayers, {\n    code: code,\n    gameStarted: gameStarted || gameEnded,\n    users: users,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 20\n    }\n  }), renderGameState());\n};\n\nexport default Play;","map":{"version":3,"sources":["/Users/farshadghazanfari/Documents/www/npat/components/Game/Play.js"],"names":["React","useState","useEffect","styled","theme","socket","FlexContainer","Spinner","ExitButton","ExitButtonContainer","InputTable","ResultsTable","ScoreTable","ActivePlayers","GameHeader","FinalScreen","StartGameScreen","Container","div","font","Play","gameData","setGamePlaying","soundOn","users","setUsers","code","setCode","currentGameRound","setCurrentGameRound","responseSubmitted","setResponseSubmitted","scoreSubmitted","setScoreSubmitted","allScoresCollected","setAllScoresCollected","allResponsesCollected","setAllResponsesCollected","currentAlphabet","setCurrentAlphabet","gameState","setGameState","gameStarted","startGame","timerValue","setTimerValue","loading","setLoading","gameEnded","setGameEnded","finalScores","setFinalScores","maxRounds","setMaxRounds","categories","setCategories","isAdmin","setAdmin","scorePartner","setScorePartner","Number","on","scorePartners","Object","assign","forEach","id","currentRound","started","scores","timer","sendResponse","response","emit","round","handleSubmitScore","score","submitScore","error","alert","handleStartGame","handleRestartGame","event","preventDefault","handleStartNextRound","renderGameState","gtag"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport styled from 'styled-components'\n\nimport theme from '../../constants/theme'\nimport { socket } from '../../constants/websocket'\nimport { FlexContainer, Spinner, ExitButton, ExitButtonContainer } from '../StyledComponents'\n\nimport InputTable from './InputTable'\nimport ResultsTable from './ResultsTable'\nimport ScoreTable from './ScoreTable'\nimport ActivePlayers from './PlayerList'\nimport GameHeader from './GameHeader'\nimport FinalScreen from './FinalScreen'\nimport StartGameScreen from './StartGameScreen'\n\nconst Container = styled.div`\n  font-family: ${theme.font};\n  padding-top: 80px;\n`\n\nconst Play = ({ gameData, setGamePlaying, soundOn }) => {\n  const [users, setUsers] = useState([]);\n  const [code, setCode] = useState('');\n  const [currentGameRound, setCurrentGameRound] = useState(1);\n  const [responseSubmitted, setResponseSubmitted] = useState(false);\n  const [scoreSubmitted, setScoreSubmitted] = useState(false);\n  const [allScoresCollected, setAllScoresCollected] = useState(false);\n  const [allResponsesCollected, setAllResponsesCollected] = useState(false);\n  const [currentAlphabet, setCurrentAlphabet] = useState('')\n  const [gameState, setGameState] = useState({});\n  const [gameStarted, startGame] = useState(false);\n  const [timerValue, setTimerValue] = useState(0);\n  const [loading, setLoading] = useState(false);\n  const [gameEnded, setGameEnded] = useState(false);\n  const [finalScores, setFinalScores] = useState([]);\n  const [maxRounds, setMaxRounds] = useState(0);\n  const [categories, setCategories] = useState([])\n  const [isAdmin, setAdmin] = useState(gameData.isAdmin)\n  const [scorePartner, setScorePartner] = useState({})\n\n\n  // const isAdmin = gameData.isAdmin;\n\n  useEffect(() => {\n    const { code, users, maxRounds, categories } = gameData;\n    setUsers(users);\n    setCode(code);\n    setMaxRounds(Number(maxRounds))\n    setCategories(categories)\n\n  }, [gameData]);\n\n  useEffect(() => {\n    socket.on(\"restartGame\", () => {\n      setFinalScores([]);\n      setGameEnded(false);\n    })\n\n    socket.on(\"gameData\", ({ users }) => {\n      setUsers(users);\n    });\n\n    socket.on(\"allSubmitted\", ({ gameState, scorePartners }) => {\n      setGameState(Object.assign({}, gameState))\n      scorePartners.forEach(scorePartner => {\n        if (scorePartner[0].id === socket.id) {\n          setScorePartner(scorePartner[1])\n        }\n      })\n      setAllResponsesCollected(true)\n    })\n\n    socket.on(\"allScoresSubmitted\", ({ gameState }) => {\n      setGameState(Object.assign({}, gameState))\n      setAllScoresCollected(true)\n    })\n\n    socket.on(\"allPlayersReady\", ({ gameState }) => {\n      setLoading(true)\n      setGameState(Object.assign({}, gameState))\n      setCurrentGameRound(gameState.currentRound);\n      setResponseSubmitted(false);\n      setAllResponsesCollected(false);\n      setAllScoresCollected(false);\n      setScoreSubmitted(false);\n      setTimerValue(0)\n      setCurrentAlphabet(gameState.currentAlphabet)\n      setLoading(false)\n    })\n\n    socket.on(\"gameStarted\", ({ gameState }) => {\n      startGame(gameState.started);\n      setCurrentAlphabet(gameState.currentAlphabet)\n    });\n\n    socket.on(\"gameEnded\", ({ scores, gameState }) => {\n      setLoading(true)\n      setGameState(Object.assign({}, gameState))\n      setCurrentGameRound(1);\n      setResponseSubmitted(false);\n      setAllResponsesCollected(false);\n      setAllScoresCollected(false);\n      setScoreSubmitted(false);\n      setTimerValue(0)\n      setCurrentAlphabet('')\n      setGameEnded(true)\n      startGame(false)\n      setLoading(false)\n      setUsers(gameState.users)\n      // New person who starts the game will be admin\n      setAdmin(false);\n      setFinalScores(scores)\n    });\n\n\n    socket.on(\"timerValue\", ({ timer }) => {\n      setTimerValue(timer)\n    })\n  }, []);\n\n  // Sumbit users respnse\n  const sendResponse = (response) => {\n    // forEach category, make a response object\n    socket.emit('sendResponse', { code, response, round: currentGameRound }, () => {\n      setResponseSubmitted(true)\n      socket.emit('stopTimer', { code })\n    })\n  }\n\n  const handleSubmitScore = (score, id) => {\n    let submitScore;\n    submitScore = score ? score : 0;\n    socket.emit('sendScore', { id, code, score: submitScore, round: currentGameRound }, ({ error, gameState }) => {\n      if (error) alert(error)\n      else if (gameState) {\n        setScoreSubmitted(true)\n      }\n    })\n  }\n\n  const handleStartGame = () => {\n    socket.emit('startGame', { code }, (gameState) => {\n      if (gameState) {\n        startGame(gameState.started)\n        setLoading(false)\n      }\n    })\n  }\n\n  const handleRestartGame = (event) => {\n    event.preventDefault()\n    startGame(false);\n    socket.emit('restartGame', { code }, () => {\n      setFinalScores([]);\n      setGameEnded(false);\n      setAdmin(true);\n    })\n\n  }\n\n  const handleStartNextRound = () => {\n    // If everyone is ready to start next round, then start next round \n    socket.emit('playerReady', { code, round: currentGameRound }, ({ gameState }) => {\n      if (gameState) {\n\n      }\n    })\n  }\n\n  const renderGameState = () => {\n    if (loading) return <FlexContainer><Spinner /></FlexContainer>\n    if (gameEnded) return <FinalScreen handleRestartGame={handleRestartGame} scores={finalScores} />\n    if (!gameStarted) return <StartGameScreen handleStartGame={handleStartGame} isAdmin={isAdmin} />\n    else if (allScoresCollected)\n      return <ScoreTable maxRounds={maxRounds} handleStartNextRound={handleStartNextRound} round={currentGameRound} gameState={gameState} />\n    else if (responseSubmitted && !allResponsesCollected)\n      return <FlexContainer><Spinner /></FlexContainer>\n    else if (allResponsesCollected)\n      return <ResultsTable scorePartner={scorePartner} scoreSubmitted={scoreSubmitted} handleSubmitScore={handleSubmitScore} round={currentGameRound} gameState={gameState} />\n    else\n      return <>\n        {(gameStarted) ? <GameHeader soundOn={soundOn} maxRounds={maxRounds} timerValue={timerValue} roundNumber={currentGameRound} currentAlphabet={currentAlphabet} /> : false}\n        <InputTable categories={categories} timerValue={timerValue} sendResponse={sendResponse} />\n      </>\n  }\n\n  return <Container>\n    <ExitButtonContainer><ExitButton onClick={() => {\n      socket.emit('removeUserFromGame', { code }, () => {\n        gtag(\"event\", \"close_game\")\n        setGamePlaying(false)\n      })\n    }}>X</ExitButton></ExitButtonContainer>\n    {!gameEnded && <ActivePlayers code={code} gameStarted={gameStarted || gameEnded} users={users} />}\n    {renderGameState()}\n  </Container>\n}\n\nexport default Play;"]},"metadata":{},"sourceType":"module"}